---
title: "Beginning Bayes / Multilevel Regression"
author: "Anna Yaggi"
date: '2022-10-19'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


Installing packages
```{r}
library(tidyverse)
Sys.setenv(MAKEFLAGS = "-j4") # four cores used
install.packages(c("Rcpp", "RcppEigen", "RcppParallel", "StanHeaders"), type = "source")
install.packages("rstan", type = "source")
library(dplyr)
library(rvest)

```

clean data, create a data set with major as a dummy variable, and 
```{r}
# satisfaction with CS111 dummy matrix
ddf$Q11_1[is.na(ddf$Q11_1)] <- 0
Q11_1_dummy <- model.matrix(~Q11_1, data = ddf)

#major dummy matrix
ddf$major[is.na(ddf$major)] <- 0
Qmajor_dummy <- model.matrix(~major, data = ddf)

#international student dummy matrix
ddf$international[is.na(ddf$international)] <- 0
Qinternational_dummy <- model.matrix(~international, data = ddf)

#gender dummy matrix
ddf$gender[is.na(ddf$gender)] <- 0
Qgender_dummy <- model.matrix(~gender, data = ddf)

#race dummy matrix
ddf$race[is.na(ddf$race)] <- 0
Qrace_dummy <- model.matrix(~race, data = ddf)

#binding all of the dummy matrices
#first_dummy <- cbind(Qmajor_dummy, Q11_1_dummy, Qinternational_dummy, Qgender_dummy)


  

```

Note: 
I tried to use race_df to define the race variables but its not working
#using race_df to assign race variables and then creating a dummy variable out of these
 race_df <- ddf %>%
    count(race) %>%
    filter(!str_detect(race, ",")) %>% # assumes each race was picked alone at least once
    transmute(
      name = tolower(race) %>%
        str_extract("[\\w\\s]+") %>%
        str_remove_all("\\s*$") %>%
        str_replace_all("\\s", "_") %>%
        str_c("race_", .),
      race_str = race
    )
  assign("race_df", race_df, envir = topenv())

  race_choice_list <- as.list(race_df$name)
  names(race_choice_list) <- race_df$race_str

  assign("race_choice_list", race_choice_list, envir = topenv())
  race_str_list <- as.list(race_df$race_str)
  names(race_str_list) <- race_df$name
  assign("race_str_list", race_str_list, envir = topenv())





Notes:how to get it from categorical to numerical
  use factors for to specify the levels (for response variables), use course_df
  mutate (as integer)
  look in report folder --> index file, has how to create the variables
  
  
  
  
