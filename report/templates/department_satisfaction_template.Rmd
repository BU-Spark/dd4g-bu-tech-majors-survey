
## {{{department}}} Department Satisfaction

This is taking all the satisfaction responses for each course in the {{{department}}} and combining them.

```{r {{{dep_code}}}_input}
input <- list(selected_dep = "{{{department}}}")
dep_select_df <-
  course_ldf %>%
    filter(str_detect(question_text, input$selected_dep))
```


### Overall Satisfaction

```{r {{{dep_code}}}_plot_overall}
dep_select_df %>%
  ggplot(aes(x = response)) +
  geom_bar() +
  scale_x_discrete(guide = guide_axis(n.dodge = 2))
```

### Satisfaction by Gender

```{r {{{dep_code}}}_plot_gender}
dep_select_df %>%
  group_by(gender) %>%
  count(response, name = "count", .drop = FALSE) %>%
  mutate(prop = count / sum(count)) %>%
  ggplot(aes(x = response, fill = gender)) %>%
  stack_freq_prop(title = input$selected_dep)
```



### Satisfaction by Race

```{r {{{dep_code}}}_plot_race}
dep_select_df %>%
  simplify_race_var() %>%
  group_by(race) %>%
  count(response, name = "count", .drop = FALSE) %>%
  mutate(prop = count / sum(count)) %>%
  ggplot(aes(x = response, fill = race)) %>%
  stack_freq_prop(title = input$selected_dep)
```


